// room script file

function room_Load()
{
  livingRoomMusic.Play();
  
  if(hasNeedToSwapWaterGlassWithEmptyGlass){
      hasNeedToSwapWaterGlassWithEmptyGlass = false;
      oLivingRoomWaterGlass.Visible = false;
      oLivingRoomEmptyGlass.Visible = true;
  }
}

function room_AfterFadeIn()
{
  if(player.PreviousRoom == 1 && hasBeenInLivingRoom){
    Verbs.MovePlayer(1070, 445);
  }
  else if(player.PreviousRoom == 2){
    Verbs.MovePlayer(1150, 508);
    player.FaceObject(oLivingRoomDoorOpened);
    oLivingRoomDoorOpened.Visible = false;
  }
  hasBeenInLivingRoom = true;
  
}

function room_FirstLoad()
{
    Verbs.MovePlayer(1165, 700);
    cElena.Say("Ya era hora que te levantases");
    player.Say("Me he quedado traspuesto");
    cElena.Say("Mira a ver tu movil");
    cElena.Say("Lleva un buen rato sonando");
    player.Say("Vale");
}

function hLivingRoomBedroomExit_Mode8()
{
  livingRoomMusic.Stop();
  player.EnterRoom(1, 155, 840, eDirectionRight);
}

function oLivingRoomDoorOpened_AnyClick()
{
 if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("TODO");
 }
 else if(Verbs.UsedAction(eGA_Close)) {
   Verbs.MovePlayer(1150, 508);
    oLivingRoomDoorOpened.Visible = false;
 }
 else if(Verbs.UsedAction(eGA_WalkTo)){
   Verbs.MovePlayer(1225, 463);
    livingRoomMusic.Stop();
  player.EnterRoom(2, 680, 1027, eDirectionDown);
 }
 else Verbs.Unhandled();
}

function hLivingRoomDoorClosed_AnyClick()
{
  if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("La puerta de la calle");
 }
 else if(Verbs.UsedAction(eGA_Open)) {
   Verbs.MovePlayer(1150, 508);
   if(hasNeedToGoOutFromHome){
     if(player.HasInventory(iCoat)){
       oLivingRoomDoorOpened.Visible = true;
       if(!hasBeenOutsideHome){
          player.Say("La verdad esta ahi fuera");
       }
     }
     else{
        player.Say("Necesito ir al badulaque pero con la que esta cayendo, no voy a salir sin abrigo");
     }
   }
   else{
      player.Say("No tengo ninguna necesidad de salir de casa");
      player.Say("A parte hace mucho frio");
   }
   
 }
 else Verbs.Unhandled();
}

function oLivingRoomMobile_AnyClick()
{
 if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("Mi movil");
 }
 else if(Verbs.UsedAction(eGA_PickUp)) {
    Verbs.AnyClickWalkLookPick(260, 760, eDirectionDown, "A la saca", oLivingRoomMobile.ID , iMobile);
    player.Say("Tengo varios mensajes");
    player.Say("Escrotor");
    player.Say("Quedamos para salir con la bici el Sabado?");
    player.Say("A tope");
    player.Say("La jimena");
    player.Say("Jugamos al padel el Domingo?");
    player.Say("Mu rico");
    cElena.Say("Tira tira...");
    player.Say("Mensaje de numero desconocido");
    player.Say("Se quien tiene lo que buscas");
    player.Say("Se quien tiene el Big Whoop");
    cElena.Say("Por fin vamos a acabar esta maldita gincana!");
    player.Say("Lo tiene...");
    Wait(40);
    player.Say("Mierda!");
    cElena.Say("Que pasa?");
    player.Say("Me he quedado sin bateria");
    player.Say("Y no me ha dado tiempo a leerlo");
    cElena.Say("Cojonudo, pues carga el movil");
    player.Say("Voy!");
    dElena.SetOptionState(2, eOptionOn);
 }
 else Verbs.Unhandled();
}

function oRemoteControl_AnyClick()
{
  if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("El poder!");
 }
 else if(Verbs.UsedAction(eGA_PickUp)) {
    Verbs.AnyClickWalkLookPick(665, 620, eDirectionDown, "A la saca", oRemoteControl.ID , iRemoteControl); 
 }
 else Verbs.Unhandled();
}

function oLivingRoomClock_AnyClick()
{
  if(Verbs.UsedAction(eGA_LookAt)) {
    if(hasNeedToFixClock){
      player.Say("Las manecillas no se mueven");
    }
    else{
      player.Say("Un reloj");
    }
 }
 else if(hasNeedToFixClock && Verbs.UsedAction(eGA_PickUp)) {
   Verbs.AnyClickWalkLookPick(665, 620, eDirectionDown, "A la saca", oLivingRoomClock.ID , iClock); 
 }
 else Verbs.Unhandled();
}

function oLivingRoomWaterGlass_AnyClick()
{
if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("TODO");
 }
 else Verbs.Unhandled();

}

function oLivingRoomEmptyGlass_AnyClick()
{
if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("TODO");
 }
 else if(Verbs.UsedAction(eGA_PickUp)) {
   Verbs.AnyClickWalkLookPick(665, 620, eDirectionDown, "A la saca", oLivingRoomEmptyGlass.ID , iEmptyGlass); 
 }
 else Verbs.Unhandled();
}

function oLivingRoomTvMatch_AnyClick()
{
if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("TODO");
 }
 else if(Verbs.UsedAction(eGA_PickUp)) {
 }
 else Verbs.Unhandled();
}



function hLivingRoomTvOff_AnyClick()
{
if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("TODO");
 }
 else if(Verbs.UsedAction(eGA_UseInv) && player.ActiveInventory == iRemoteControl){
    Verbs.MovePlayer(685, 585);
    oLivingRoomTvMatch.Visible = true;
    Wait(30);
    cElena.Say("Otra vez futbol...");
    cElena.Say("Colombia Ghana?");
    Wait(5);
    cJuan.Say("No, van empate");
    Wait(20);
    cElena.Say("Madre mia...");
 }
 else Verbs.Unhandled();
}
  

function cElena_AnyClick()
{
  if(Verbs.UsedAction(eGA_LookAt)) {
    player.Say("Quiza no lo parezca, pero es ella");
   }
    else if(Verbs.UsedAction(eGA_TalkTo)) {
    Verbs.MovePlayer(1165, 700);
    player.Say("Kuklinski!");
    cElena.Say("Que pasa?");
    dElena.Start();
 }
 else if(Verbs.UsedAction(eGA_GiveTo)){
   
    if(Verbs.GetItemGiven() == iWaterGlass){
      oLivingRoomWaterGlass.Visible = true;
      cElena.Say("Gracias!");
      hasGivenWaterGlassToElena = true;
      if(hasGivenIbuprofenToElena){
        dElena.SetOptionState(6, eOptionOffForever);
        dElena.SetOptionState(7, eOptionOn);
      }
    }
    else if(Verbs.GetItemGiven() == iIbuprofen){
      cElena.Say("Gracias!");
      hasGivenIbuprofenToElena = true;
      if(hasGivenWaterGlassToElena){
        dElena.SetOptionState(6, eOptionOffForever);
        dElena.SetOptionState(7, eOptionOn);
      }
    }
 }
   else Verbs.Unhandled();
}


function hClockNail_AnyClick()
{

if(Verbs.UsedAction(eGA_LookAt)) {
  player.Say("Ahi se sujeta el reloj");
 }
 else if(Verbs.UsedAction(eGA_UseInv) && player.ActiveInventory == iClock){
    Verbs.MovePlayer(685, 585);
    player.LoseInventory(iClock);
    oLivingRoomClock.Visible = true;
    if(hasPutBatteriesOnClock){
        player.Say("Arreglao");
        player.Say("Menudo genio soy");
        dElena.SetOptionState(4, eOptionOffForever);
        dElena.SetOptionState(5, eOptionOn);
        
    }
 }
 else Verbs.Unhandled();
}
